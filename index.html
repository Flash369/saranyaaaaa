<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Happy Valentine's Day</title>
    
    <!-- Fonts: Cormorant Garamond (Premium Serif), DM Sans (Clean Sans), Great Vibes (Signature) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=DM+Sans:wght@300;400;500&family=Great+Vibes&display=swap" rel="stylesheet">
    
    <!-- GSAP for Animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        /* --- VARIABLES & RESET --- */
        :root {
            /* 1. Blush Rose (#F4C2C2) - Buttons
               2. Ivory Whisper (#FFF6EE) - Background
               3. Deep Wine (#7A2E3A) - Headings, Highlights
               4. Warm Mocha (#4A3B36) - Body text
               5. Soft Gold Dust (#D8B56A) - Underlines, icons
            */
            --bg-color: #FFF6EE;      /* Ivory Whisper */
            --white: #FFFFFF;         
            --gold: #D8B56A;          /* Soft Gold Dust */
            --text-heading: #7A2E3A;  /* Deep Wine */
            --text-body: #4A3B36;     /* Warm Mocha */
            --btn-bg: #F4C2C2;        /* Blush Rose */
            --btn-text: #7A2E3A;      /* Deep Wine */
            --paper-color: #fffbf7;   
            
            --font-heading: 'Cormorant Garamond', serif;
            --font-body: 'DM Sans', sans-serif;
            --font-signature: 'Great Vibes', cursive;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent; /* Remove blue tap box on mobile */
        }

        body {
            background-color: var(--bg-color);
            /* Radial gradient from Ivory to Blush Rose */
            background: radial-gradient(circle at center, #FFF6EE 0%, #F4C2C2 100%);
            color: var(--text-body);
            font-family: var(--font-body);
            overflow: hidden; 
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- BACKGROUND PARTICLES --- */
        #canvas-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* --- LAYOUT CONTAINER --- */
        .container {
            width: 100%;
            max-width: 650px; /* Optimal width for reading */
            height: 100%;
            position: relative;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        /* --- SECTIONS --- */
        section {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 1.5rem;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        section.active {
            opacity: 1;
            visibility: visible;
            pointer-events: all;
            z-index: 10;
        }

        /* --- TYPOGRAPHY --- */
        h1, h2, h3 {
            font-family: var(--font-heading);
            color: var(--text-heading);
            line-height: 1.1;
            margin-bottom: 1.5rem;
        }

        h1 { font-size: 3.5rem; font-weight: 700; letter-spacing: -1px; }
        h2 { font-size: 2.2rem; font-weight: 600; }
        h3 { font-size: 1.5rem; font-weight: 500; font-style: italic; }

        p {
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-body);
            margin-bottom: 2rem;
            max-width: 90%;
        }
        
        .highlight { color: var(--gold); font-style: italic; }

        /* --- BUTTONS --- */
        .btn {
            background-color: var(--btn-bg);
            color: var(--btn-text);
            font-family: var(--font-body);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 0.85rem;
            padding: 14px 35px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
            margin-top: 10px;
            border-radius: 4px; /* Slight rounding for the solid button look */
            box-shadow: 0 4px 15px rgba(244, 194, 194, 0.4);
        }

        .btn:hover { 
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(244, 194, 194, 0.6);
            filter: brightness(0.95); /* Slight dim on hover */
        }
        
        .btn:active { transform: scale(0.95); }
        
        /* Specific small buttons for mood selection */
        .btn-mood {
            padding: 10px 20px;
            font-size: 0.75rem;
            margin: 5px;
            background-color: var(--white);
            border: 1px solid var(--btn-bg);
            box-shadow: none;
        }
        .btn-mood:hover {
            background-color: var(--btn-bg);
        }

        /* --- INPUTS --- */
        input[type="text"] {
            background: transparent;
            border: none;
            border-bottom: 1px solid var(--gold);
            padding: 10px;
            font-family: var(--font-heading);
            font-size: 1.3rem;
            text-align: center;
            width: 80%;
            color: var(--text-heading);
            outline: none;
            margin-bottom: 2rem;
            border-radius: 0; 
        }
        
        /* --- CARDS & GRIDS --- */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            width: 100%;
            margin-bottom: 20px;
        }
        
        .grid-item {
            background: var(--white);
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 8px;
            border: 1px solid rgba(216, 181, 106, 0.3); 
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-size: 0.85rem;
            position: relative;
            overflow: hidden;
            border-radius: 6px;
        }

        .grid-item.locked { background: rgba(255, 255, 255, 0.6); color: var(--gold); font-size: 1.4rem; }
        .grid-item.unlocked { background: var(--white); color: var(--text-body); border-color: var(--gold); box-shadow: 0 4px 15px rgba(216, 181, 106, 0.2); }
        .hidden-content { display: none; font-size: 0.8rem; line-height: 1.3; color: var(--text-body); }

        /* --- SPECIFIC PAGE STYLES --- */
        
        /* Page 6: Countdown - Deep Wine Background for contrast */
        .countdown-timer {
            font-family: var(--font-heading);
            font-size: 2.2rem;
            color: var(--gold);
            margin: 20px 0;
        }
        .timer-label {
            font-family: var(--font-body);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #e0e0e0; 
            margin-top: 5px;
        }

        /* Page 7: The Letter */
        .letter-container {
            background: var(--paper-color);
            padding: 2.5rem 2rem;
            box-shadow: 0 10px 30px rgba(122, 46, 58, 0.05); 
            width: 100%;
            max-height: 75vh;
            overflow-y: auto;
            position: relative;
            text-align: left;
            border-radius: 2px;
            /* Subtle texture effect */
            background-image: linear-gradient(var(--paper-color) 0%, var(--paper-color) 100%), url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjZmZmOWYwIi8+CjxwYXRoIGQ9M00xIDNoMnYxSDF6IiBmaWxsPSIjZjRmMGU2IiBmaWxsLW9wYWNpdHk9IjAuMDUiLz4KPC9zdmc+');
        }
        
        .letter-content {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.25rem;
            line-height: 1.7;
            color: var(--text-body);
        }
        
        .letter-content p {
            text-indent: 0;
            margin-bottom: 1.2rem;
            color: var(--text-body);
            max-width: 100%;
        }

        .signature-block {
            margin-top: 3rem;
            text-align: right;
            padding-right: 1rem;
        }

        .with-love {
            font-family: 'Cormorant Garamond', serif;
            font-style: italic;
            font-size: 1.1rem;
            color: var(--text-heading);
            display: block;
            margin-bottom: 0.2rem;
        }

        .signature-name {
            font-family: var(--font-signature);
            font-size: 2rem;
            color: var(--text-heading);
        }

        /* Scrollbar for letter */
        .letter-container::-webkit-scrollbar { width: 6px; }
        .letter-container::-webkit-scrollbar-thumb { background-color: var(--btn-bg); border-radius: 3px; }

        /* Page 11: Unlock */
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--gold); }
        input:checked + .slider:before { transform: translateX(22px); }

        .loading-bar { width: 0%; height: 3px; background: var(--gold); margin: 25px auto; border-radius: 2px; display: none; }
        .gift-reveal-text { display: none; margin-top: 25px; font-size: 1.4rem; font-weight: 600; color: var(--text-heading); line-height: 1.5; }

        /* Page 12: Gemini AI */
        #ai-response {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.3rem;
            min-height: 80px;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255,255,255,0.5);
            border-radius: 8px;
            color: var(--text-heading);
            font-style: italic;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .mood-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            margin-bottom: 20px;
        }

        /* --- MOBILE OPTIMIZATION --- */
        @media (max-width: 480px) {
            h1 { font-size: 2.5rem; }
            h2 { font-size: 1.8rem; }
            p { font-size: 1rem; }
            .container { padding: 1.5rem; }
            
            .grid-container { grid-template-columns: 1fr 1fr; gap: 8px; }
            .grid-item { height: 70px; font-size: 0.75rem; }
            
            .letter-container { padding: 2rem 1.5rem; max-height: 65vh; }
            .letter-content { font-size: 1.15rem; }
            
            .btn { padding: 12px 30px; font-size: 0.8rem; }
        }
    </style>
</head>
<body>

    <!-- AUDIO PLAYER -->
    <audio id="bg-music" loop>
        <source src="./song.mp3" type="audio/mp3">
    </audio>

    <!-- Background Canvas for Particles -->
    <canvas id="canvas-bg"></canvas>

    <div class="container">

        <!-- PAGE 1: HERO -->
        <section id="page-1" class="active">
            <h1 class="hero-title">Hii, babe<br><span class="highlight">Here is your Valentine gift...</span></h1>
            <p style="font-size: 1.1rem; opacity: 0.9; margin-top: 10px;">
                Not perfect<br>
                Just something made with my hands,<br>
                and my heart üíì for you.
            </p>
            <button class="btn" onclick="startExperience()">Enter the Experience</button>
        </section>

        <!-- PAGE 2: TEASE 1 -->
        <section id="page-2">
            <h2 style="margin-bottom: 30px;">
                You know what?
            </h2>
            <div style="font-size: 2rem; color: var(--gold); margin-top: 30px;">‚ú®</div>
            <button class="btn" style="margin-top: 40px;" onclick="nextSection(2)">Next</button>
        </section>

        <!-- PAGE 3: TEASE 2 -->
        <section id="page-3">
            <h2 style="margin-bottom: 30px; font-size: 1.8rem;">
                Some people enter your life softly,<br>
                and before you realize it,<br>
                they become the place you feel safest.<br>
                That‚Äôs you.
            </h2>
            <button class="btn" style="margin-top: 40px;" onclick="nextSection(3)">Next</button>
        </section>

        <!-- PAGE 4: UNIVERSE -->
        <section id="page-4">
            <h2 style="margin-bottom: 30px;">
                My favorite word is ‚ÄúUniverse.‚Äù<br>
                Because it begins with U,<br>
                and somehow ends with everything I feel.<br>
            </h2>
            <button class="btn" style="margin-top: 40px;" onclick="nextSection(4)">Next</button>
        </section>

        <!-- PAGE 5: 10 THINGS -->
        <section id="page-5">
            <h3 style="margin-bottom: 25px; color: var(--text-heading);">10 Things I Love About You</h3>
            <div class="grid-container" id="grid-things">
                <!-- JS will inject items here -->
            </div>
            <button class="btn" id="btn-page-5" style="display:none; margin-top: 20px;" onclick="nextSection(5)">Continue the Journey</button>
        </section>

        <!-- PAGE 6: COUNTDOWN -->
        <section id="page-6" style="background: var(--text-heading); color: white;">
            <h2 style="color: #fff; opacity: 0.9;">The Journey</h2>
            <p style="color: #e0e0e0; max-width: 500px;">It was 6 June 2025, we first exchanged words....<br>And that small moment brought us all the way here.</p>
            
            <div class="countdown-timer">
                <div id="timer-display">000 Days</div>
                <div class="timer-label">Since we started talking</div>
            </div>
            
            <button class="btn" style="border-color: rgba(255,255,255,0.5); color: white; margin-top: 30px;" onclick="nextSection(6)">Next</button>
        </section>

        <!-- PAGE 7: LETTER -->
        <section id="page-7">
            <div class="letter-container">
                <div class="letter-content">
                    <p><strong>Happy Valentine‚Äôs Day, my wifey ‚ù§Ô∏è</strong></p>

                    <p>a.k.a. my fuddu larki,<br>and the person I love the most.</p>

                    <p>I don‚Äôt always know how to put feelings into perfect words, but one thing I know for sure, you are my home. And once you find home, you stop looking anywhere else.</p>

                    <p>You‚Äôre the person I can‚Äôt imagine a life without, the one my heart casually chose and now refuses to negotiate about.</p>

                    <p>All I want is you by my side ‚Äì no grand demands, no extra wishes. Just us. Laughing, growing, annoying each other, and building a future that feels like ours.</p>

                    <p>I want to make you feel loved, on the loud days and the quiet ones, on the days you shine and the days you forget that you do.</p>

                    <p>I‚Äôve said it before, and I‚Äôll say it again ‚Äì you are the most important person in my world, and my heart is very serious about you.</p>

                    <p>You are rare. You are valuable. Your presence matters more than you realize.</p>

                    <p>So stay exactly who you are, keep shining, keep smiling, because you‚Äôre a star‚Ä¶ and stars don‚Äôt ask for permission to glow ‚ú®üíì</p>
                    
                    <div class="signature-block">
                        <span class="with-love">Always yours,</span>
                        <span class="signature-name">Raj</span>
                    </div>
                </div>
            </div>
            <button class="btn" style="margin-top: 20px;" onclick="nextSection(7)">Next</button>
        </section>

        <!-- PAGE 8: INPUT VERIFICATION -->
        <section id="page-8">
            <h3 style="font-weight: 400; margin-bottom: 5px;">Type exactly:</h3>
            <p class="highlight" style="font-size: 1rem; margin-bottom: 25px;">"I love you raj and I'll always do"</p>
            <input type="text" id="magic-input" placeholder="Type here..." autocomplete="off">
            <button class="btn" onclick="checkInput()">Submit</button>
        </section>

        <!-- PAGE 9: TEASE LINE -->
        <section id="page-9">
            <h2>Do you know what, Saranya?</h2>
            <button class="btn" onclick="nextSection(9)">Next</button>
        </section>

        <!-- PAGE 10: DRAMATIC REVEAL -->
        <section id="page-10">
            <h1>I'm your gift, my sannu</h1>
            <h3 style="margin-top: -10px;">Come and unwrap me.</h3>
            <br><br>
            <p style="font-size: 1.2rem; color: var(--gold);">Naughty harkatein üòã</p>
            <button class="btn" onclick="nextSection(10)">Next</button>
        </section>

        <!-- PAGE 11: UNLOCK ANIMATION -->
        <section id="page-11">
            <h2>Unlock Your Real Gift</h2>
            <div style="margin: 30px 0;">
                <label class="switch">
                    <input type="checkbox" id="gift-toggle" onchange="unlockGift()">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="loading-bar" id="gift-loader"></div>
            <div class="gift-reveal-text" id="gift-msg">
                Your gift is unlocked:<br>
                <span style="color: var(--text-heading); display: block; margin-top: 15px; font-size: 1.4rem;">Fuddu ghar jaake khud dekh lena shammmm ko hehe</span>
                <span style="font-size: 2rem; margin-top: 10px; display: block;">üòÇ</span>
            </div>
            <button class="btn" id="btn-final" style="display:none; margin-top:30px;" onclick="nextSection(11)">Next</button>
        </section>

        <!-- PAGE 12: GEMINI AI POEM -->
        <section id="page-12">
            <h2 style="font-size: 2.5rem; margin-bottom: 10px;">Cupid's Muse ‚ú®</h2>
            <p>Still want more words? Let the stars write a poem just for us.</p>
            
            <div class="mood-buttons">
                <button class="btn btn-mood" onclick="generateLoveNote('Romantic')">Romantic ‚ù§Ô∏è</button>
                <button class="btn btn-mood" onclick="generateLoveNote('Funny')">Funny üòÇ</button>
                <button class="btn btn-mood" onclick="generateLoveNote('Spicy')">Spicy üå∂Ô∏è</button>
                <button class="btn btn-mood" onclick="generateLoveNote('Sweet')">Sweet üç¨</button>
            </div>

            <div id="ai-response">Pick a mood above...</div>
            
            <button class="btn" onclick="nextSection(12)">Finish</button>
        </section>

        <!-- PAGE 13: ENDING -->
        <section id="page-13">
            <div style="padding: 2rem; background: #fff; box-shadow: 0 10px 40px rgba(122, 46, 58, 0.1); border-radius: 8px;">
                <h2 style="color: var(--text-heading);">Have a beautiful day cutie</h2>
                <p>Wishing you every ounce of happiness üíã</p>
                <p>Take care, hottieüòã</p>
            </div>
        </section>

    </div>

    <script>
        /* --- STATE MANAGEMENT --- */
        let currentSection = 1;
        const totalSections = 13;

        /* --- 10 THINGS DATA --- */
        const things = [
            "I love your smile the kind that fixes my worst days without trying",
            "I love how effortlessly cute you are, even when you don‚Äôt notice it yourself",
            "I love how you make me laugh, not just with jokes, but with your presence",
            "I love how you made me feel loved, in ways I didn‚Äôt even know I needed",
            "I love how adorable you are, especially when you‚Äôre being completely you",
            "Your natural prettiness, the kind that doesn‚Äôt ask for attention, but steals it anyway",
            "The caring version of you, the one that feels like warmth in human form",
            "That clumsy smile, the one that shows up when you‚Äôre shy or happy or both",
            "The way you get annoyed, and somehow look even more lovable doing it",
            "Your big dreams, and that quiet fire inside you, the urge to chase them no matter what"
        ];
        let unlockedThings = 0;

        /* --- INITIALIZATION --- */
        document.addEventListener('DOMContentLoaded', () => {
            initParticles();
            initThingsGrid();
            startCountdown();
            
            // Hero Animation
            gsap.from(".hero-title", { duration: 1.5, y: 50, opacity: 0, ease: "power3.out" });
            gsap.from(".hero-title span", { duration: 1.5, color: "#7A2E3A", delay: 0.5 });
            gsap.from("#page-1 p", { duration: 1.5, opacity: 0, delay: 1 });
        });

        /* --- AUDIO & START --- */
        function startExperience() {
            const audio = document.getElementById('bg-music');
            audio.volume = 0.3;
            audio.play().catch(error => {
                console.log("Audio play failed, showing prompt if supported.");
            });
            nextSection(1);
        }

        /* --- NAVIGATION --- */
        function nextSection(current) {
            const next = current + 1;
            const currentEl = document.getElementById(`page-${current}`);
            const nextEl = document.getElementById(`page-${next}`);

            if (!nextEl) return;

            // GSAP Exit Animation
            gsap.to(currentEl, {
                duration: 0.6,
                opacity: 0,
                y: -30,
                ease: "power2.in",
                onComplete: () => {
                    currentEl.classList.remove('active');
                    nextEl.classList.add('active');
                    
                    // Reset position for entrance
                    gsap.set(nextEl, { y: 30, opacity: 0 });
                    
                    // GSAP Entrance Animation
                    gsap.to(nextEl, {
                        duration: 0.8,
                        opacity: 1,
                        y: 0,
                        ease: "power2.out"
                    });

                    // Special Page Triggers
                    if(next === 7) animateLetter();
                }
            });
        }

        /* --- PAGE 5: 10 THINGS LOGIC --- */
        function initThingsGrid() {
            const container = document.getElementById('grid-things');
            things.forEach((thing, index) => {
                const item = document.createElement('div');
                item.className = 'grid-item locked';
                item.innerHTML = `<span class="lock-icon">üîí</span><span class="hidden-content">${thing}</span>`;
                item.onclick = () => revealThing(item);
                container.appendChild(item);
            });
        }

        function revealThing(element) {
            if (!element.classList.contains('locked')) return;

            element.classList.remove('locked');
            element.classList.add('unlocked');
            
            const content = element.querySelector('.hidden-content');
            const icon = element.querySelector('.lock-icon');
            
            icon.style.display = 'none';
            content.style.display = 'block';

            gsap.from(element, { scale: 0.9, duration: 0.3, ease: "back.out(1.7)" });

            unlockedThings++;
            if (unlockedThings === things.length) {
                gsap.to("#btn-page-5", { display: "inline-block", opacity: 1, duration: 0.5, delay: 0.5 });
            }
        }

        /* --- PAGE 6: COUNTDOWN LOGIC --- */
        function startCountdown() {
            // Set date to 6 June 2025
            const startDate = new Date('2025-06-06T00:00:00');
            const display = document.getElementById('timer-display');

            setInterval(() => {
                const now = new Date();
                const diff = now - startDate;

                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);

                display.innerText = `${days}d ${hours}h ${minutes}m ${seconds}s`;
            }, 1000);
        }

        /* --- PAGE 7: LETTER ANIMATION --- */
        function animateLetter() {
            gsap.from(".letter-container", {
                y: 50,
                opacity: 0,
                duration: 1.5,
                ease: "power3.out",
                delay: 0.2
            });
        }

        /* --- PAGE 8: INPUT LOGIC --- */
        function checkInput() {
            const input = document.getElementById('magic-input');
            const val = input.value.trim().toLowerCase().replace(/\s+/g, ' '); 
            // Normalized password string
            const correct = "i love you raj and i'll always do";
            const correctNoApostrophe = "i love you raj and ill always do";

            if (val === correct || val === correctNoApostrophe) {
                nextSection(8);
            } else {
                gsap.to(input, { x: -10, duration: 0.1, yoyo: true, repeat: 5 });
                input.style.borderBottomColor = "#d68c92"; 
                setTimeout(() => input.style.borderBottomColor = "var(--gold)", 1000);
            }
        }

        /* --- PAGE 11: GIFT UNLOCK LOGIC --- */
        function unlockGift() {
            const toggle = document.getElementById('gift-toggle');
            const loader = document.getElementById('gift-loader');
            const msg = document.getElementById('gift-msg');
            const btn = document.getElementById('btn-final');

            if (toggle.checked) {
                toggle.disabled = true;
                loader.style.display = 'block';

                gsap.to(loader, {
                    width: "60%",
                    duration: 4,
                    ease: "power1.inOut",
                    onComplete: () => {
                        loader.style.display = 'none';
                        msg.style.display = 'block';
                        gsap.from(msg, { scale: 0.8, opacity: 0, duration: 0.8, ease: "elastic.out(1, 0.5)" });
                        confettiExplosion();
                        btn.style.display = "inline-block";
                    }
                });
            }
        }
        
        /* --- PAGE 12: GEMINI AI LOGIC --- */
        async function generateLoveNote(mood) {
            const responseDiv = document.getElementById('ai-response');
            responseDiv.innerHTML = "Asking Cupid... ‚ú®";
            
            const apiKey = ""; // Added by runtime
            const prompt = `Write a short, ${mood.toLowerCase()} 4-line poem for my girlfriend Saranya. Keep it cute, loving, and specific to a Valentine's context. Sign it 'Your Raj'.`;
            
            try {
                // Retry logic helper
                const fetchWithRetry = async (url, options, retries = 3, backoff = 1000) => {
                    for (let i = 0; i < retries; i++) {
                        try {
                            const response = await fetch(url, options);
                            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                            return response;
                        } catch (error) {
                            if (i === retries - 1) throw error;
                            await new Promise(r => setTimeout(r, backoff * Math.pow(2, i)));
                        }
                    }
                };

                const response = await fetchWithRetry(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
                    {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{ text: prompt }]
                            }]
                        })
                    }
                );

                const data = await response.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "Cupid is taking a nap. Try again!";
                
                // Format the response for HTML (handle newlines)
                responseDiv.innerHTML = text.replace(/\n/g, '<br>');
                
                // Animate the text in
                gsap.from(responseDiv, { opacity: 0, y: 10, duration: 0.5 });
                
            } catch (error) {
                console.error("Gemini API Error:", error);
                responseDiv.innerHTML = "Cupid got lost in the clouds. Try again later! ‚ù§Ô∏è";
            }
        }

        /* --- BACKGROUND PARTICLES --- */
        function initParticles() {
            const canvas = document.getElementById('canvas-bg');
            const ctx = canvas.getContext('2d');
            
            function resize() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            resize();
            window.addEventListener('resize', resize);

            const particles = [];
            
            class Particle {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * 2;
                    this.speedX = Math.random() * 0.5 - 0.25;
                    this.speedY = Math.random() * 0.5 - 0.25;
                    // Colors: Gold Dust, Blush Rose, Deep Wine
                    const pColors = ['#D8B56A', '#F4C2C2', '#7A2E3A', '#FFFFFF'];
                    this.color = pColors[Math.floor(Math.random() * pColors.length)]; 
                    // Add transparency
                    this.color = this.color + '66'; // 40% hex opacity approx
                }
                update() {
                    this.x += this.speedX;
                    this.y += this.speedY;
                    if (this.size > 0.2) this.size -= 0.01; 
                    else this.size += 0.01; 
                    
                    if (this.x > canvas.width || this.x < 0) this.speedX *= -1;
                    if (this.y > canvas.height || this.y < 0) this.speedY *= -1;
                }
                draw() {
                    ctx.fillStyle = this.color;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                }
            }

            for (let i = 0; i < 40; i++) particles.push(new Particle());

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => { p.update(); p.draw(); });
                requestAnimationFrame(animate);
            }
            animate();
        }

        /* --- CONFETTI --- */
        function confettiExplosion() {
            // Updated confetti colors
            const colors = ['#D8B56A', '#F4C2C2', '#7A2E3A', '#FFF'];
            for(let i=0; i<80; i++) {
                const el = document.createElement('div');
                el.style.position = 'fixed';
                el.style.left = '50%';
                el.style.top = '50%';
                el.style.width = '8px';
                el.style.height = '8px';
                el.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
                el.style.zIndex = '999';
                el.style.pointerEvents = 'none';
                document.body.appendChild(el);

                gsap.to(el, {
                    x: (Math.random() - 0.5) * 400,
                    y: (Math.random() - 0.5) * 400,
                    rotation: Math.random() * 360,
                    opacity: 0,
                    duration: 2.5,
                    ease: "power2.out",
                    onComplete: () => el.remove()
                });
            }
        }
    </script>
</body>
</html>
